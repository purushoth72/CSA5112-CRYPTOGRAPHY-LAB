import string

def generate_key(plaintext, keyword):
    """Repeat or trim the keyword to match the plaintext length."""
    keyword = keyword.upper()
    key = ""
    i = 0
    for ch in plaintext:
        if ch.isalpha():
            key += keyword[i % len(keyword)]
            i += 1
        else:
            key += ch
    return key

def encrypt(plaintext, keyword):
    """Encrypt plaintext using a Vigenère (polyalphabetic) cipher."""
    plaintext = plaintext.upper()
    key = generate_key(plaintext, keyword)
    cipher_text = ""

    for p, k in zip(plaintext, key):
        if p.isalpha():
            shift = ord(k) - ord('A')
            cipher_char = chr((ord(p) - ord('A') + shift) % 26 + ord('A'))
            cipher_text += cipher_char
        else:
            cipher_text += p
    return cipher_text

def decrypt(ciphertext, keyword):
    """Decrypt ciphertext using the Vigenère (polyalphabetic) cipher."""
    ciphertext = ciphertext.upper()
    key = generate_key(ciphertext, keyword)
    plain_text = ""

    for c, k in zip(ciphertext, key):
        if c.isalpha():
            shift = ord(k) - ord('A')
            plain_char = chr((ord(c) - ord('A') - shift) % 26 + ord('A'))
            plain_text += plain_char
        else:
            plain_text += c
    return plain_text


if __name__ == "__main__":
    mode = input("Mode (E=encrypt, D=decrypt): ").strip().upper()
    plaintext_or_ciphertext = input("Enter text: ")
    keyword = input("Enter keyword: ")

    if mode == 'E':
        cipher = encrypt(plaintext_or_ciphertext, keyword)
        print("Ciphertext:", cipher)
    elif mode == 'D':
        plain = decrypt(plaintext_or_ciphertext, keyword)
        print("Decrypted text:", plain)
    else:
        print("Invalid mode. Use E or D.")
