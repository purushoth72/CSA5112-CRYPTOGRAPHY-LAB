PYTHON PROGRAM FOR FOR DSA SIGNATURE VARIABILITY

from Crypto.Signature import DSS
from Crypto.Hash import SHA256
from Crypto.PublicKey import DSA
from Crypto.Random import get_random_bytes

# Generate DSA key pair
key = DSA.generate(1024)

# Message to sign
message = b"Same message signed twice"

# Hash the message
hash_obj = SHA256.new(message)

# Sign the message twice
signer1 = DSS.new(key, 'fips-186-3')
signature1 = signer1.sign(hash_obj)

# Rehash and sign again
hash_obj2 = SHA256.new(message)
signer2 = DSS.new(key, 'fips-186-3')
signature2 = signer2.sign(hash_obj2)

print("Signature 1:", signature1.hex())
print("Signature 2:", signature2.hex())
print("Signatures are different:", signature1 != signature2)

PYTHON PROGRAM FOR RSA SIGNATURE DETERMINISM

from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import rsa, padding
from cryptography.hazmat.backends import default_backend

# Generate RSA key pair
private_key = rsa.generate_private_key(
    public_exponent=65537,
    key_size=2048,
    backend=default_backend()
)

# Message to sign
message = b"Same message signed twice"

# Hash the message
digest = hashes.Hash(hashes.SHA256(), backend=default_backend())
digest.update(message)
hashed_message = digest.finalize()

# Sign the hash twice using PKCS#1 v1.5 (deterministic)
signature1 = private_key.sign(
    hashed_message,
    padding.PKCS1v15(),
    hashes.SHA256()
)

signature2 = private_key.sign(
    hashed_message,
    padding.PKCS1v15(),
    hashes.SHA256()
)

# Output signatures
print("Signature 1:", signature1.hex())
print("Signature 2:", signature2.hex())
print("Signatures are identical:", signature1 == signature2)

